window.backboneApp={Models:{},Collections:{},Views:{},Routers:{},init:function(){new this.Views.TodosView({collection:new this.Collections.TodosCollection})}},$(document).ready(function(){backboneApp.init()}),this.JST=this.JST||{},this.JST["app/scripts/templates/todo.ejs"]=function(obj){obj||(obj={});var __t,__p="";with(_.escape,Array.prototype.join,obj)__p+='<input type="checkbox" ',completed&&(__p+="checked"),__p+='>\n<form>\n    <input type="text" value="'+(null==(__t=title)?"":__t)+'">\n</form>\n<span>\n    '+(null==(__t=title)?"":__t)+"\n</span>\n";return __p},this.JST["app/scripts/templates/todos.ejs"]=function(obj){obj||(obj={});var __p="";with(_.escape,obj)__p+='<form class="input-append">\n    <input type="text" id="new-todo" placeholder="What do you need to do today?">\n    <input type="submit" class="btn" value="Submit">\n</form>\n<ul>\n    <!-- Where our To Do items will go -->\n</ul>\n';return __p},backboneApp.Collections.TodosCollection=Backbone.Collection.extend({localStorage:new Backbone.LocalStorage("backbone-generator-todos"),initialize:function(){this.model=backboneApp.Models.TodoModel}}),backboneApp.Models.TodoModel=Backbone.Model.extend({defaults:{title:"",completed:!1},toggle:function(){this.save({completed:!this.get("completed")})}}),backboneApp.Views.TodosView=Backbone.View.extend({el:"#todo-app",template:JST["app/scripts/templates/todos.ejs"],events:{submit:"createTodo"},initialize:function(){this.render(),this.listenTo(this.collection,"add",this.addTodoItem),this.listenTo(this.collection,"reset",this.addAllTodoItems),this.collection.fetch()},render:function(){return this.$el.html(this.template()),this},createTodo:function(a){a.preventDefault();var b=this.$("#new-todo").val().trim();b&&(this.collection.create(new backboneApp.Models.TodoModel({title:b})),$("#new-todo").val(""))},addTodoItem:function(a){var b=new backboneApp.Views.TodoView({model:a});this.$("ul").append(b.render().el)},addAllTodoItems:function(){this.collection.each(this.addTodoItem,this)}}),backboneApp.Views.TodoView=Backbone.View.extend({tagName:"li",template:JST["app/scripts/templates/todo.ejs"],events:{'click input[type="checkbox"]':"toggle","dblclick span":"toggleEdit","submit form":"toggleEdit"},initialize:function(){this.listenTo(this.model,"change",this.render)},render:function(){return this.$el.html(this.template(this.model.toJSON())),this},toggle:function(){this.model.toggle()},toggleEdit:function(){var a=this.$("form input"),b=a.val().trim();return b?(this.$el.toggleClass("editing"),void(b===this.model.get("title")?(a.val(b),a.focus()):(this.model.set("title",b),this.model.save(),this.render()))):(this.model.destroy(),void this.remove())}});